<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Posts | Academic</title>
    <link>/post/</link>
      <atom:link href="/post/index.xml" rel="self" type="application/rss+xml" />
    <description>Posts</description>
    <generator>Wowchemy (https://wowchemy.com)</generator><language>en-us</language><lastBuildDate>Mon, 23 Nov 2020 00:00:00 +0000</lastBuildDate>
    <image>
      <url>/images/icon_hu8fa43e4483d02e4bfdf294b3386ef244_148313_512x512_fill_lanczos_center_2.png</url>
      <title>Posts</title>
      <link>/post/</link>
    </image>
    
    <item>
      <title>Food Chemistry | 基于高光谱预测小麦籽粒微量营养</title>
      <link>/post/2020-11-23-food-chemistry-%E4%BA%8E%E9%AB%98%E5%85%89%E8%B0%B1%E9%A2%84%E6%B5%8B%E5%B0%8F%E9%BA%A6%E7%B1%BD%E7%B2%92%E5%BE%AE%E9%87%8F%E8%90%A5%E5%85%BB/</link>
      <pubDate>Mon, 23 Nov 2020 00:00:00 +0000</pubDate>
      <guid>/post/2020-11-23-food-chemistry-%E4%BA%8E%E9%AB%98%E5%85%89%E8%B0%B1%E9%A2%84%E6%B5%8B%E5%B0%8F%E9%BA%A6%E7%B1%BD%E7%B2%92%E5%BE%AE%E9%87%8F%E8%90%A5%E5%85%BB/</guid>
      <description>&lt;p&gt;这是发表的小麦联盟公众号上的推文，搬运至此，记录一下。同时也为自己做一波广告。这是开展表型研究的第一篇文章。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;小麦作为主要粮食作物，其含有多种人类健康所需微量营养素。然而现有的小麦品种微量营养含量不能够满足人体的营养需求，因此，一些以小麦为主食的发展中国家“隐性饥饿”问题尤为严重。据统计，全球共有20亿人患有一种或多种慢性微量营养素缺乏症，其中我国占15%。因此，通过技术手段进一步提高小麦的微量营养含量、为全世界的人们提供高营养品质的小麦显得尤为重要。&lt;/p&gt;
&lt;p&gt;通过小麦育种进行生物强化是提高小麦微量营养的主要方法之一。然而，筛选大量的小麦种质资源需要大量的基于实验室的小麦微量营养的测量。传统的微量营养含量的测定方法准确度高，但存在耗时、费力、昂贵、且污染环境等缺点，不能经济、快速地完成大量小麦种质资源的微量营养测定，从而限制了育种的适用性。因此，有必要开发一种高通量、经济的小麦微量营养测定方法。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://gitee.com/wellionx/myimg/raw/master/foodchem%E6%88%AA%E5%9B%BE.png&#34; alt=&#34;文章截图&#34;&gt;&lt;/p&gt;
&lt;p&gt;近日，中国农业大学农学院作物生态生理研究团队在《&lt;strong&gt;Food Chemistry&lt;/strong&gt;》（中科院一区，TOP期刊，IF 6.306）发表题为&lt;strong&gt;Predicting micronutrients of wheat using hyperspectral imaging&lt;/strong&gt;的研究论文。研究人员收集了多种栽培管理条件下的不同小麦品种共计631份样品，采用高光谱技术成功实现小麦籽粒微量营养的快速无损检测。研究还发现，基于完整籽粒光谱预测微量营养较面粉光谱预测有更好的预测效果。而且，本研究中预测小麦籽粒和面粉中的&lt;strong&gt;Zn、Ca、Mo&lt;/strong&gt;以及&lt;strong&gt;Mg&lt;/strong&gt;等营养元素含量，具有较高的预测准确率。这一方法的应用，将为筛选和培育高营养品质的小麦新品种提供机会，同时也可以将其用于其他谷物的营养评估。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://gitee.com/wellionx/myimg/raw/master/Foodchefigure2.png&#34; alt=&#34;图1 小麦籽粒和面粉光谱&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://gitee.com/wellionx/myimg/raw/master/Foodchefigure3.png&#34; alt=&#34;图2 小麦籽粒和面粉中Ca、Mo和Zn的预测效果&#34;&gt;&lt;/p&gt;
&lt;p&gt;中国农业大学农学院博士生&lt;strong&gt;胡乃月&lt;/strong&gt;和博士后&lt;strong&gt;李伟&lt;/strong&gt;为论文共同第一作者，农学院&lt;strong&gt;王志敏&lt;/strong&gt;教授、&lt;strong&gt;张英华&lt;/strong&gt;副教授和&lt;strong&gt;于康&lt;/strong&gt;副教授为论文通讯作者，工学院&lt;strong&gt;杨丽&lt;/strong&gt;教授参与了本项研究。论文第一单位为中国农业大学。该研究得到了国家重点研发计划、现代农业产业体系以及国家自然科学基金的支持。&lt;/p&gt;
&lt;p&gt;来源：https://doi.org/10.1016/j.foodchem.2020.128473&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Go through the process of GWAS</title>
      <link>/post/go-through-the-process-of-gwas/</link>
      <pubDate>Thu, 03 Sep 2020 00:00:00 +0000</pubDate>
      <guid>/post/go-through-the-process-of-gwas/</guid>
      <description>


&lt;div id=&#34;耗时近一月终于将关联分析流程跑通&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;耗时近一月，终于将关联分析流程跑通&lt;/h2&gt;
&lt;p&gt;GWAS又名全基因组关联分析，是一种基因定位的方法。该方法基于自然群体和历史重组进行表型和基因型相关性的挖掘，是一种快速开展基因定位的方法。&lt;/p&gt;
&lt;p&gt;其实从实施过程来讲，关联分析并不复杂。无非就是收集表型性状，结合基因型分型数据，利用软件（如TASSEL）提供的统计分析方法计算与表型显著相关的SNP位点。&lt;/p&gt;
&lt;p&gt;下面就根据我自己的经历，简单介绍下我做GWAS的一些经验。&lt;/p&gt;
&lt;div id=&#34;表型&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;1. 表型&lt;/h3&gt;
&lt;p&gt;对于很多研究来说，表型收集的成本其实非常高。不仅要将大量的自交系种到田间进行测试，还要消耗很多劳动力进行表型采集，这个过程中时间和金钱的消耗都非常大。所以能够采用高通量的方法进行表型收集应该是一大幸事。&lt;/p&gt;
&lt;div id=&#34;光谱指数&#34; class=&#34;section level4&#34;&gt;
&lt;h4&gt;1.1 光谱指数&lt;/h4&gt;
&lt;p&gt;本研究就是采用高光谱仪进行表型数据采集工作，采集到的叶片光谱包含大量关于叶片结构和功能特征的信息。基于前人的研究，构建起多个光谱指数表型性状用于研究叶片功能性状的遗传特征。&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;光谱主成分&#34; class=&#34;section level4&#34;&gt;
&lt;h4&gt;1.2 光谱主成分&lt;/h4&gt;
&lt;p&gt;此外，光谱采集到的大部分数据是冗余的，因此将其做了主成分分析，选取前3个主成分作为叶片光学特征性状。依据主成分性状也进行关联分析。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;基因型&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;2. 基因型&lt;/h3&gt;
&lt;p&gt;关联分析群体来做国家玉米改良中心杨小红课题组。华中农大严建兵老师课题组在该群体55K芯片基因型的基础上又做了大量基因分型的工作，将总的SNP标记数量增加到125万。本研究采用严老师课题组网站（maizego.org）公布的基因型进行GWAS分析。&lt;/p&gt;
&lt;div id=&#34;群体结构&#34; class=&#34;section level4&#34;&gt;
&lt;h4&gt;2.1 群体结构&lt;/h4&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Linking spectra to genetic diversity</title>
      <link>/post/linking-spectra-to-genetic-diversity/</link>
      <pubDate>Sat, 25 Jul 2020 00:00:00 +0000</pubDate>
      <guid>/post/linking-spectra-to-genetic-diversity/</guid>
      <description>&lt;p&gt;之前看到的一篇&lt;a href=&#34;https://doi.org/10.3732/ajb.1700061&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;文章&lt;/a&gt;。里面有一张图印象深刻，大意是遗传上有差异的种质，其叶片的光谱必然也存在某种变异。这点和现在正在做的叶片光学特征的遗传解析问题不谋而合。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://tva1.sinaimg.cn/mw690/6b84e15bly1gh3ia726kij21dm0i8wjp.jpg&#34; alt=&#34;linking spectra to functional and phylogenetic diversity&#34;&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>HSI and its potential for rapid single-kernel analysis</title>
      <link>/post/hsi-and-its-potential-for-rapid-single-kernel-analysis/</link>
      <pubDate>Fri, 24 Jul 2020 00:00:00 +0000</pubDate>
      <guid>/post/hsi-and-its-potential-for-rapid-single-kernel-analysis/</guid>
      <description>&lt;p&gt;于老师推荐的一篇&lt;a href=&#34;https://doi.org/10.1080/05704928.2018.1425214&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Reviewer&lt;/a&gt;，关于光谱相机的。里面重点介绍对谷物籽粒化学成分检测，并探讨应用于单籽粒检测上。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://tvax2.sinaimg.cn/mw690/6b84e15bly1gh1vbzqgdsj20t50lfwi6.jpg&#34; alt=&#34;HSI single kernel for chemical composition-Review&#34;&gt;
以上展示的是作者推荐的一套流程，将光谱相机用于小麦籽粒化学成分分析。&lt;/p&gt;
&lt;p&gt;这张图不禁让我想起Food Chemistry上的一篇文章，当时因为图中也有籽粒成分的图像而让我印象深刻。&lt;a href=&#34;http://dx.doi.org/10.1016/j.foodchem.2017.07.048&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;文章链接在此&lt;/a&gt;
&lt;img src=&#34;https://tvax3.sinaimg.cn/mw690/6b84e15bly1gh1vbkka5gj20pa0obwif.jpg&#34; alt=&#34;HSI single kernel for chemical composition-food chem&#34;&gt;&lt;/p&gt;
&lt;p&gt;因为刚好做过类似的研究，想着以后是否可以探索将此技术应用起来，尤其是单籽粒成分图像的分析上。甚至可以脑洞大开，分析叶片，籽粒内部各成分的空间差异。用于解释外在的处理效果。&lt;/p&gt;
&lt;p&gt;顺便探讨下，光谱分析不能仅仅局限在二维的谱线数据，而应该拓展到三维空间，分析光谱图像上来了。&lt;/p&gt;
&lt;p&gt;分析方法和思路的转变都会带来革新，加油吧。&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>认知偏差</title>
      <link>/post/%E8%AE%A4%E7%9F%A5%E5%81%8F%E5%B7%AE/</link>
      <pubDate>Tue, 21 Jul 2020 00:00:00 +0000</pubDate>
      <guid>/post/%E8%AE%A4%E7%9F%A5%E5%81%8F%E5%B7%AE/</guid>
      <description>&lt;p&gt;最近的一些事情，让我想到人的认知偏差，之前看到的一张解释认知偏差的图。
配图的&lt;a href=&#34;https://www.imtqy.com/dk-effect.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;原文在此&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://tva1.sinaimg.cn/mw690/6b84e15bgy1ggyimf34s8j20zk0zk0up.jpg&#34; alt=&#34;dk-effect&#34;&gt;&lt;/p&gt;
&lt;p&gt;有机会再把这个话题展开来讲。&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Visualize my spectra (1) </title>
      <link>/post/visualize-my-spectra/</link>
      <pubDate>Thu, 16 Jul 2020 00:00:00 +0000</pubDate>
      <guid>/post/visualize-my-spectra/</guid>
      <description>


&lt;p&gt;从去年开始就一直在分析光谱的数据，刚开始以为R里面会有包能解决我关于光谱的所有问题。经过一段时间的试错之后，我发现自己错了。&lt;/p&gt;
&lt;p&gt;于是记录下来我自己实践的过程。&lt;/p&gt;
&lt;div id=&#34;批量读取光谱数据&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;批量读取光谱数据&lt;/h3&gt;
&lt;p&gt;一般来说，拿到的原始光谱数据数据有这样的特点：&lt;/p&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;&lt;strong&gt;光谱反射率和光谱吸收值夹杂在文件内部。&lt;/strong&gt;以SR3501的数据为例，打开之后是这样的(如下图所示)。文件内部有很多关于仪器和配置的信息。真正对我们有价值的数据在27行以后。具体的就是此处的两列数据，第一列为波长，第二列为对应的反射率。所以这就要求读取数据的时候找到指定的行。
&lt;img src=&#34;https://tva3.sinaimg.cn/mw690/6b84e15bgy1ggsq5agy8xj20m80gmmyq.jpg&#34; alt=&#34;SR3501sedfile&#34; /&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;2.&lt;strong&gt;数据文件不止一个，常常需要批量读取。&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;于是经过多次试错与总结，写下了下面的方法批量读取指定行的光谱数据。&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# get file names of all spectra
dir = &amp;quot;Spec/&amp;quot;
files = list.files(path = dir ,recursive = TRUE)
# read spectra from AB files
filepath = paste(dir, files, sep = &amp;#39;&amp;#39;)
# define a dataframe to store spectra data
spec.bdf &amp;lt;- data.frame()

for (flp in filepath) {
  spec &amp;lt;- read.table(flp, skip = 27, header = F ,
                     stringsAsFactors = F,row.names = 1)
  spec.t &amp;lt;- as.data.frame(t(spec))
  spec.bdf &amp;lt;- rbind(spec.bdf, spec.t)
}&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;根据需求，有时候要对数据做一下转置。转置后再把所有的数据bind到一起。&lt;/p&gt;
&lt;p&gt;采用&lt;code&gt;ggplot2&lt;/code&gt;绘图，需要的是长数据，原来两列的数据正好符合要求，只需要添加一列信息即可。&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# get file names of all spectra
dir = &amp;quot;Spec/&amp;quot;
files = list.files(path = dir ,recursive = TRUE)
# read spectra from AB files
filepath = paste(dir, files, sep = &amp;#39;&amp;#39;)
# define a dataframe to store spectra data
spec.bdf &amp;lt;- data.frame()

for (flp in filepath) {
  
  spec &amp;lt;- read.table(flp, skip = 27, header = F ,stringsAsFactors = F)
  colnames(spec) &amp;lt;- c(&amp;quot;Wavelengths&amp;quot;,&amp;quot;Reflectance&amp;quot;)
  spec$unique_id &amp;lt;- basename(flp)
  spec.df &amp;lt;- rbind(spec.df, spec)
  
}&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;有了数据就可以展示了，下面是选出来100条光谱进行的展示。&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(ggplot2)
library(cowplot)
load(file = &amp;quot;show spectra.rda&amp;quot;)
# Define nice breaks for x axis
brk  &amp;lt;- pretty(as.numeric(unique(spec$Wavelengths)), n = 10)
spec.df$grp &amp;lt;- &amp;quot;A&amp;quot;

ggplot(spec.df, aes(Wavelengths, Reflectance,group = unique_id)) +
  geom_line(aes(color = grp),alpha = 0.7, size = 0.6) +
  scale_x_continuous(breaks = brk) +
  theme_cowplot() +
  scale_color_manual(values = &amp;quot;black&amp;quot;) +
  theme(legend.position = &amp;quot;none&amp;quot;) # remove the legend&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2020-07-16-visualize-my-spectra.en_files/figure-html/unnamed-chunk-3-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;为了好看，我们还可以给每条光谱加上颜色&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/post/2020-07-16-visualize-my-spectra.en_files/figure-html/unnamed-chunk-4-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;后续更多有意思的分析且听下回分解&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;后续更多有意思的分析，且听下回分解&lt;/h3&gt;
&lt;p&gt;先附上几张图，再留着以后慢慢讲&lt;/p&gt;
&lt;div class=&#34;figure&#34;&gt;
&lt;img src=&#34;https://tvax1.sinaimg.cn/mw690/6b84e15bgy1ggxf7b8k2oj22s02bcqgb.jpg&#34; alt=&#34;&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;spectra organ separate&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;figure&#34;&gt;
&lt;img src=&#34;https://tvax4.sinaimg.cn/mw690/6b84e15bgy1ggxf5q5604j21fd0o6kg0.jpg&#34; alt=&#34;&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;Spectra and PCA&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;figure&#34;&gt;
&lt;img src=&#34;https://tvax4.sinaimg.cn/mw690/6b84e15bgy1ggxf72iem5j21hd0mmwqq.jpg&#34; alt=&#34;&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;spectra PCA&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Add font to a photo</title>
      <link>/post/add-font-to-a-photo/</link>
      <pubDate>Thu, 09 Jul 2020 00:00:00 +0000</pubDate>
      <guid>/post/add-font-to-a-photo/</guid>
      <description>


&lt;p&gt;在正式写推文之前，又发现了一个坑——Markdown的图片路径不支持中文。所以推文的名字不能用中文，因为推文内部的图片都是用推文名字索引的(尴尬)。&lt;/p&gt;
&lt;p&gt;首先看下成果吧。
(原图做了压缩才push上来的)&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://tva1.sinaimg.cn/large/6b84e15bgy1gglu2tb81hj20ee0pm4qp.jpg&#34; /&gt;&lt;/p&gt;
&lt;p&gt;在Y叔公众号看到一篇文章(&lt;a href=&#34;https://mp.weixin.qq.com/s/pnU3CH2T0FISCnsxeUQgQg&#34;&gt;用R给高考学生送祝福吧&lt;/a&gt;)，图片中添加文字，用R可以实现。觉得很有意思，于是测试了一下，竟然翻车了。所以将这个过程记录下来，以便有机会用上这个功能。&lt;/p&gt;
&lt;p&gt;实现这个功能用的的R包并不复杂，只有&lt;code&gt;showtext&lt;/code&gt;、&lt;code&gt;ggplot2&lt;/code&gt;和&lt;code&gt;ggimage&lt;/code&gt;三个。&lt;code&gt;showtext&lt;/code&gt;用来显示个性化的字体(如本例用的maocao), &lt;code&gt;ggplot2&lt;/code&gt;用来画图，&lt;code&gt;ggimage&lt;/code&gt;用来添加图片背景。&lt;/p&gt;
&lt;p&gt;一开始加载字体就出现了问题，基于某些特殊原因，未能直接访问google，所以字体只能下载后本地加载。&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(showtext)
font_add(&amp;quot;maocao&amp;quot;, &amp;quot;D:\\Data\\goupanddownwithR\\LiuJianMaoCao-Regular.ttf&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;下一步按照Y叔的操作，打开&lt;code&gt;showtext&lt;/code&gt;，创建ggplot图像，将文字添加进去，并指定了字体maocao，再讲图片导入，一切都很顺利。&lt;/p&gt;
&lt;p&gt;然而最终出来的图和Y叔的不一样——字体没有变。&lt;/p&gt;
&lt;p&gt;于是搜索原因，试了各种方法都没有成功。在stackoverflow上的一个回答引起了我的注意，图形设备竟然还分win和pdf以及png。&lt;/p&gt;
&lt;p&gt;刚好这时候，查到了邱怡轩(&lt;code&gt;showtext&lt;/code&gt;包的作者)在统计之都上的一篇文章。他用R画图，添加的文字都是用Cairo包开启的png设备。于是我也按照指引尝试了一下，果然奏效。&lt;/p&gt;
&lt;p&gt;代码如下：&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(Cairo)
Cairo.capabilities() # 检查Cairo的兼容性
# 打开图形设备
CairoPNG(&amp;quot;leftrighthand.jpg&amp;quot;, 2590, 4608);
showtext_auto()

d = data.frame(x=0:1)

p = ggplot(d, aes(x,x)) + geom_blank() +
  annotate(&amp;quot;text&amp;quot;, x=.73, y=.91, angle = -10,
           label=&amp;quot;左手nature\n右手science&amp;quot;,color = &amp;quot;white&amp;quot;,
           family=&amp;quot;maocao&amp;quot;, size=88) +
  theme_void()

#指定图片位置
img &amp;lt;- &amp;#39;D:/Data/左手nature右手science.jpg&amp;#39;
ggbackground(p, img)

# 停止使用showtext
showtext_end()
# 关闭图形设备
dev.off()&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;最后做了个小的尝试，为了方便图片在markdown(这篇博客就是用markdown写的)中的引用，将图片上传到了新浪图床。图片上传图床用的&lt;a href=&#34;https://segmentfault.com/a/1190000020251841&#34;&gt;新浪微博图床插件&lt;/a&gt;,在Chrome应用商店可以直接下载。登录微博账号，即可使用。拖拽上传也非常方便。&lt;/p&gt;
&lt;p&gt;看下图床提供的图片效果，做了一下大小的适配。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://tvax4.sinaimg.cn/wap720/6b84e15bgy1ggluf73y45j20ee0pm4qp.jpg&#34; /&gt;&lt;/p&gt;
&lt;div id=&#34;one-more-thing.&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;One more thing.&lt;/h3&gt;
&lt;p&gt;某次看到Y叔博客的另一个包，也出现了显示问题。里面的解释让我明白了图片上加字体失败的原因，原来就是图形设备的锅。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;showtext 本身和 RStudio GD 存在兼容性问题，所以在 Rstudio 中会出现各种问题，这也是为什么直接用png()保存则正常。因此给出的解决建议是即便在使用 Rstudio，也还是用系统本身的 GD 去打印，在Windows中就用 windows() 在 Mac 中就用 quartz()，然后万事大吉功成身退。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&#34;figure&#34;&gt;
&lt;img src=&#34;https://tvax1.sinaimg.cn/mw690/6b84e15bgy1ggrl5prcamj21a40rcu0x.jpg&#34; alt=&#34;&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;图形设备的锅&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>挖坑待填</title>
      <link>/post/%E6%8C%96%E5%9D%91%E5%BE%85%E5%A1%AB/</link>
      <pubDate>Mon, 06 Jul 2020 00:00:00 +0000</pubDate>
      <guid>/post/%E6%8C%96%E5%9D%91%E5%BE%85%E5%A1%AB/</guid>
      <description>


&lt;div id=&#34;统计一下挖过的坑&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;统计一下挖过的坑&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;小麦植株地下部，用R画出来&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;基本思路与地上部分的画法相同，先找轮廓，然后描摹&lt;/li&gt;
&lt;li&gt;图形展示还没想好，可能根部的养分测定，按照区域测的会有区别&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;顺便想起是否可以画地下部不同土层的轮廓，基本构思还需要在考虑一下&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;气象数据的可视化&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;附近气象站点&lt;/li&gt;
&lt;li&gt;气象数据如何获取&lt;/li&gt;
&lt;li&gt;气象数据的筛选与整理&lt;/li&gt;
&lt;li&gt;气象数据展示（柱状图展示降雨，折线散点展示温度等）&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Draw wheat chart in R</title>
      <link>/post/draw-wheat-chart-in-r/</link>
      <pubDate>Sat, 04 Jul 2020 00:00:00 +0000</pubDate>
      <guid>/post/draw-wheat-chart-in-r/</guid>
      <description>


&lt;p&gt;&lt;img src=&#34;/post/2020-07-04-draw-wheat-chart-in-r.en_files/wheatplots.jpg&#34; /&gt;&lt;/p&gt;
&lt;p&gt;前几天，在微信公众号里看到有个R包（gganatogram) 可以画动物和植物的图形，但是里面的小麦不好看。于是把我用R画的小麦分享出来，比一比哪个更好看😜。&lt;/p&gt;
&lt;p&gt;话不多说，先上图。
&lt;img src=&#34;/post/2020-07-04-draw-wheat-chart-in-r.en_files/img1.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;先说说为什么要画这么一个图。&lt;/p&gt;
&lt;p&gt;那是在我刚进课题组的时候，就了解到实验室有大量小麦的数据。而且是从叶片到茎秆再到穗和籽粒等等各种器官一应俱全。更让人惊喜的是这些数据时间跨度大。当时我就在想，用什么样的方式才能展示出来这么丰富的空间和时间变化呢？&lt;/p&gt;
&lt;p&gt;一次偶然的机会，我联想到地图，地图里面的各个区域由多边形组成，区域的数值变化可以通过填色来完成。眼尖的同学应该看出来了，里面正是我华北平原的吴桥实验站（手动笑脸）。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/post/2020-07-04-draw-wheat-chart-in-r.en_files/img2.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;而我们一株小麦上的各个器官正好对应着地图上不同区域。利用小麦不同器官的轮廓图，勾勒出多边形，再把多边形组合，就形成一株完整的小麦。&lt;/p&gt;
&lt;p&gt;有了这个想法之后，我就开始实施。首先从网上找到一株小麦的矢量图（就是各器官能分开的图形），然后根据各部分的轮廓创建多边形。是的，图形数据化用到了一款开源软件，名为&lt;a href=&#34;https://automeris.io/WebPlotDigitizer/&#34;&gt;WebPlotDigitizer&lt;/a&gt;。这款软件非常强大，可以提取图像或者图片中的坐标数据。这里特别提一句，小麦植株的比例做了一些微调，可能与真实的有点出入，但是不影响数据展示。还有一点，我们课题组专门研究地上部分的，暂时还没把根(器官)加进去，不过后期会考虑。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/post/2020-07-04-draw-wheat-chart-in-r.en_files/img3.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/post/2020-07-04-draw-wheat-chart-in-r.en_files/img4.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;多边形创建采用了专门处理gis数据的R包sf。&lt;/p&gt;
&lt;p&gt;最后的成品就是前面看到的这个样子了。每一个部分都可以根据自己的需求填上任意的颜色。而且颜色也可以根据需求自己选择，颜色的深浅代表指标的高低。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/post/2020-07-04-draw-wheat-chart-in-r.en_files/img5.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/post/2020-07-04-draw-wheat-chart-in-r.en_files/figure-html/unnamed-chunk-1-1.png&#34; width=&#34;672&#34; /&gt;
也可以给每个部分添加标签，放上对应的数据。这样看起来好是不是好很多。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/post/2020-07-04-draw-wheat-chart-in-r.en_files/figure-html/unnamed-chunk-2-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;再来一张动图看看。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/post/2020-07-04-draw-wheat-chart-in-r.en_files/mygif.gif&#34; /&gt;&lt;/p&gt;
&lt;p&gt;好吧，最后公布一下那个R包里面的小麦。貌似也没那么难看 😄&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/post/2020-07-04-draw-wheat-chart-in-r.en_files/wheatbygganotom.png&#34; /&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Show the local weather</title>
      <link>/post/show-the-local-weather/</link>
      <pubDate>Sat, 04 Jul 2020 00:00:00 +0000</pubDate>
      <guid>/post/show-the-local-weather/</guid>
      <description>


&lt;p&gt;&lt;strong&gt;最近降雨似乎比往年多了很多，突然觉得有必要记录一下降雨的数据&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;下面就是从中国气象数据网获得的逐小时数据分析顺义降雨情况。&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;数据是从6月19号开始收集的，先展示一下小时的降水&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;C&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2020-07-04-show-the-local-weather.en_files/figure-html/unnamed-chunk-1-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;降雨集中的几个小时，数据挤在一起就不好看清楚了。于是进一步算了一下日降水量。并且我们还关注最近7天累计的降水有多少。所以用折线加散点的方式展示了近7天的累计降水。最后可以看出，近7日的累计降水达到11.5 mm&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/post/2020-07-04-show-the-local-weather.en_files/figure-html/unnamed-chunk-2-1.png&#34; width=&#34;672&#34; /&gt;
&lt;strong&gt;再看下海淀区的情况，最近降水比顺义多好多，近7日总降水达到100mm&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/post/2020-07-04-show-the-local-weather.en_files/figure-html/unnamed-chunk-3-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>
